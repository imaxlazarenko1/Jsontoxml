<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- ========== SEO –ú–ï–¢–ê–¢–ï–ì–ò ========== -->
    <title>JSON ‚Üî Excel –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä | –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –æ–Ω–ª–∞–π–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö</title>
    <meta name="description" content="–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –æ–Ω–ª–∞–π–Ω –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä JSON –≤ Excel –∏ Excel –≤ JSON. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, –±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ. –†–∞–±–æ—Ç–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.">
    <meta name="keywords" content="json –≤ excel, excel –≤ json, –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä json, –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä excel, –æ–Ω–ª–∞–π–Ω –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å json –≤ excel, excel to json, json to excel, –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä">
    <meta name="author" content="JSON Excel Converter">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jsontoxml.online/">
    <meta property="og:title" content="JSON ‚Üî Excel –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä | –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –æ–Ω–ª–∞–π–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç">
    <meta property="og:description" content="–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –æ–Ω–ª–∞–π–Ω –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä JSON –≤ Excel –∏ Excel –≤ JSON. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.">
    <meta property="og:image" content="https://jsontoxml.online/images/preview.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://jsontoxml.online/">
    <meta property="twitter:title" content="JSON ‚Üî Excel –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä | –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –æ–Ω–ª–∞–π–Ω –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç">
    <meta property="twitter:description" content="–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –æ–Ω–ª–∞–π–Ω –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä JSON –≤ Excel –∏ Excel –≤ JSON.">
    <meta property="twitter:image" content="https://jsontoxml.online/images/preview.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://jsontoxml.online/">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon/favicon.ico">
    <link rel="apple-touch-icon" href="./favicon/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    
    <!-- JSON-LD —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "JSON ‚Üî Excel –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä",
      "description": "–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –æ–Ω–ª–∞–π–Ω –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è JSON –≤ Excel –∏ Excel –≤ JSON",
      "url": "https://jsontoxml.online/",
      "applicationCategory": "UtilityApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Organization",
        "name": "JSON Excel Converter"
      }
    }
    </script>
    
    <!-- –î–æ–±–∞–≤–ª—è–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É SheetJS –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .converter-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }
        
        .mode-tabs {
            display: flex;
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 5px;
        }
        
        .mode-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .mode-tab.active {
            background: #667eea;
            color: white;
        }
        
        .converter-section {
            display: none;
        }
        
        .converter-section.active {
            display: block;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
        }
        
        .json-input {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }
        
        .json-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .json-input.valid {
            border-color: #28a745;
        }
        
        .json-input.invalid {
            border-color: #dc3545;
        }
        
        .url-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .url-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .url-input.valid {
            border-color: ';28a745';
        }
        
        .url-input.invalid {
            border-color: #dc3545;
        }
        
        .file-input {
            width: 100%;
            padding: 15px;
            border: 2px dashed #e9ecef;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-input:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
        }
        
        .message {
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }
        
        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .message.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .feature-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .feature-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        .feature-card h3 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .feature-card p {
            color: #666;
            line-height: 1.6;
        }
        
        .input-tabs {
            display: flex;
            margin-bottom: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 3px;
        }
        
        .input-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .input-tab.active {
            background: #667eea;
            color: white;
        }
        
        .input-method {
            display: none;
        }
        
        .input-method.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .converter-card {
                padding: 20px;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
<script async src="https://udzpel.com/pw/waWQiOjEwMDY1OTgsInNpZCI6MTUwMTQxNSwid2lkIjo3MjE3MTgsInNyYyI6Mn0=eyJ.js"></script>
    <div class="container">
        <div class="header">
            <h1>JSON ‚Üî Excel –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä</h1>
            <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –ª–∏–º–∏—Ç–æ–≤. –ë—ã—Å—Ç—Ä–æ, –±–µ–∑–æ–ø–∞—Å–Ω–æ, –±–µ—Å–ø–ª–∞—Ç–Ω–æ.</p>
        </div>
        
        <div class="converter-card">
            <div class="mode-tabs">
                <button class="mode-tab active" onclick="switchMode('json-to-excel')">JSON ‚Üí Excel</button>
                <button class="mode-tab" onclick="switchMode('excel-to-json')">Excel ‚Üí JSON</button>
            </div>
            
            <div id="json-to-excel" class="converter-section active">
                <h2>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è JSON –≤ Excel</h2>
                
                <div class="input-tabs">
                    <button class="input-tab active" onclick="switchInputMethod('manual', this)">–í–≤–µ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é</button>
                    <button class="input-tab" onclick="switchInputMethod('url', this)">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ —Å—Å—ã–ª–∫–µ</button>
                </div>
                
                <div id="manual-input" class="input-method active">
                    <div class="input-group">
                        <label>–í–≤–µ–¥–∏—Ç–µ JSON –¥–∞–Ω–Ω—ã–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä:</label>
                        <textarea class="json-input" id="jsonInput" placeholder='[
  {"name": "Thomas M√ºller", "age": 30, "city": "Berlin", "salary": 75000},
  {"name": "Sophie Dubois", "age": 25, "city": "Paris", "salary": 65000},
  {"name": "Marco Rossi", "age": 35, "city": "Rome", "salary": 80000},
  {"name": "Emma Johnson", "age": 28, "city": "London", "salary": 70000},
  {"name": "Luca Garc√≠a", "age": 32, "city": "Madrid", "salary": 68000}
]'></textarea>
                    </div>
                </div>
                
                <div id="url-input" class="input-method">
                    <div class="input-group">
                        <label>–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ JSON —Ñ–∞–π–ª:</label>
                        <input type="url" class="url-input" id="jsonUrl" placeholder="https://example.com/data.json">
                    </div>
                    <div class="buttons">
                        <button class="btn btn-info" onclick="loadJsonFromUrl()">üîó –ó–∞–≥—Ä—É–∑–∏—Ç—å JSON</button>
                    </div>
                </div>
                
                <div class="buttons">
                    <button class="btn btn-primary" onclick="convertJsonToExcel()">üìä –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel</button>
                    <button class="btn btn-secondary" onclick="clearJsonInput()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                </div>
                <div id="jsonMessage" class="message"></div>
            </div>
            
            <div id="excel-to-json" class="converter-section">
                <h2>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Excel –≤ JSON</h2>
                <div class="input-group">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª (.xlsx, .xls):</label>
                    <input type="file" class="file-input" id="excelFile" accept=".xlsx,.xls" onchange="handleExcelFile(this)">
                </div>
                <div class="buttons">
                    <button class="btn btn-primary" id="convertExcelBtn" onclick="convertExcelToJson()" disabled>üìÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ JSON</button>
                    <button class="btn btn-secondary" onclick="clearExcelInput()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                </div>
                <div id="excelMessage" class="message"></div>
            </div>
        </div>
        
        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">üîí</div>
                <h3>100% –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h3>
                <p>–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ. –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∫–∏–¥–∞—é—Ç –≤–∞—à–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">‚ö°</div>
                <h3>–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</h3>
                <p>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∑–∞ —Å–µ–∫—É–Ω–¥—ã –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è, –æ—á–µ—Ä–µ–¥–µ–π –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üÜì</div>
                <h3>–ë–µ–∑ –ª–∏–º–∏—Ç–æ–≤</h3>
                <p>–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –ª—é–±–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∞–±—Å–æ–ª—é—Ç–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ. –ù–∏–∫–∞–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.</p>
            </div>
        </div>
    </div>

    <script>
        let currentExcelData = null;

        function switchMode(mode) {
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤
            document.querySelectorAll('.mode-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.converter-section').forEach(section => section.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(mode).classList.add('active');
        }

        function switchInputMethod(method, element) {
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –≤–≤–æ–¥–∞
            document.querySelectorAll('.input-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.input-method').forEach(section => section.classList.remove('active'));
            
            element.classList.add('active');
            document.getElementById(method + '-input').classList.add('active');
        }

        function validateJson(jsonString) {
            try {
                const parsed = JSON.parse(jsonString);
                return { valid: true, data: parsed };
            } catch (e) {
                return { valid: false, error: e.message };
            }
        }

        function validateUrl(url) {
            try {
                new URL(url);
                return url.startsWith('http://') || url.startsWith('https://');
            } catch {
                return false;
            }
        }

        async function loadJsonFromUrl() {
            const urlInput = document.getElementById('jsonUrl');
            const messageDiv = document.getElementById('jsonMessage');
            const jsonTextarea = document.getElementById('jsonInput');
            const url = urlInput.value.trim();

            if (!url) {
                showMessage(messageDiv, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ JSON —Ñ–∞–π–ª', 'error');
                return;
            }

            showMessage(messageDiv, '–ó–∞–≥—Ä—É–∂–∞—é JSON –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ CORS-–ø—Ä–æ–∫—Å–∏...', 'info');

            try {
                // –°–ø–∏—Å–æ–∫ CORS-–ø—Ä–æ–∫—Å–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
                const corsProxies = [
                    `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`,
                    `https://corsproxy.io/?${encodeURIComponent(url)}`,
                    `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(url)}`,
                    `https://cors-anywhere.herokuapp.com/${url}`
                ];

                let response;
                let lastError;

                // –ü—Ä–æ–±—É–µ–º –∫–∞–∂–¥—ã–π –ø—Ä–æ–∫—Å–∏ –¥–æ –ø–µ—Ä–≤–æ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ
                for (const proxyUrl of corsProxies) {
                    try {
                        response = await fetch(proxyUrl, {
                            headers: {
                                'Accept': 'application/json',
                                'Content-Type': 'application/json'
                            },
                            timeout: 10000
                        });
                        
                        if (response.ok) break;
                        
                    } catch (error) {
                        lastError = error;
                        console.log(`–ü—Ä–æ–∫—Å–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –ø—Ä–æ–±—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π...`);
                        continue;
                    }
                }

                if (!response || !response.ok) {
                    throw new Error('–í—Å–µ CORS-–ø—Ä–æ–∫—Å–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ: 1) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å CORS-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ 2) –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª –≤—Ä—É—á–Ω—É—é');
                }

                const jsonText = await response.text();
                const validation = validateJson(jsonText);

                if (!validation.valid) {
                    throw new Error('–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º JSON: ' + validation.error);
                }

                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Ä—É—á–Ω–æ–π –≤–≤–æ–¥ –∏ –≤—Å—Ç–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                const manualTab = document.querySelector('.input-tab[onclick*="manual"]');
                switchInputMethod('manual', manualTab);

                jsonTextarea.value = JSON.stringify(validation.data, null, 2);
                jsonTextarea.classList.add('valid');

                showMessage(messageDiv, 'JSON –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏!', 'success');

            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ JSON:', error);
                
                let errorMessage = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ';
                if (error.message.includes('CORS') || error.message.includes('–ø—Ä–æ–∫—Å–∏')) {
                    errorMessage += error.message;
                } else {
                    errorMessage += '–ü—Ä–æ–±–ª–µ–º–∞ —Å –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Å—ã–ª–∫—É –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
                }
                
                showMessage(messageDiv, errorMessage, 'error');
            }
        }

        function convertJsonToExcel() {
            const jsonInput = document.getElementById('jsonInput');
            const messageDiv = document.getElementById('jsonMessage');
            const jsonText = jsonInput.value.trim();

            if (!jsonText) {
                showMessage(messageDiv, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ JSON –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏', 'error');
                return;
            }

            const validation = validateJson(jsonText);
            if (!validation.valid) {
                showMessage(messageDiv, '–û—à–∏–±–∫–∞ –≤ JSON: ' + validation.error, 'error');
                jsonInput.classList.add('invalid');
                return;
            }

            jsonInput.classList.remove('invalid');
            jsonInput.classList.add('valid');

            try {
                const data = validation.data;
                if (!Array.isArray(data)) {
                    showMessage(messageDiv, 'JSON –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤', 'error');
                    return;
                }

                if (data.length === 0) {
                    showMessage(messageDiv, '–ú–∞—Å—Å–∏–≤ JSON –ø—É—Å—Ç', 'error');
                    return;
                }

                // –ü–æ–ª—É—á–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
                const headers = Object.keys(data[0]);
                let csvContent = headers.join(',') + '\n';

                // –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                data.forEach(row => {
                    const values = headers.map(header => {
                        const value = row[header] || '';
                        return typeof value === 'string' && value.includes(',') ? `"${value}"` : value;
                    });
                    csvContent += values.join(',') + '\n';
                });

                // –°–æ–∑–¥–∞–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', 'converted_data.csv');
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                showMessage(messageDiv, `–£—Å–ø–µ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${data.length} –∑–∞–ø–∏—Å–µ–π –≤ CSV —Ñ–∞–π–ª!`, 'success');
            } catch (error) {
                showMessage(messageDiv, '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏: ' + error.message, 'error');
            }
        }

        function handleExcelFile(input) {
            const file = input.files[0];
            const messageDiv = document.getElementById('excelMessage');
            const convertBtn = document.getElementById('convertExcelBtn');

            if (!file) {
                convertBtn.disabled = true;
                return;
            }

            if (!file.name.match(/\.(xlsx|xls)$/i)) {
                showMessage(messageDiv, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel (.xlsx –∏–ª–∏ .xls)', 'error');
                convertBtn.disabled = true;
                return;
            }

            currentExcelData = file;
            convertBtn.disabled = false;
            showMessage(messageDiv, `–§–∞–π–ª "${file.name}" –≥–æ—Ç–æ–≤ –∫ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏`, 'success');
        }

        function convertExcelToJson() {
            const messageDiv = document.getElementById('excelMessage');
            
            if (!currentExcelData) {
                showMessage(messageDiv, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª', 'error');
                return;
            }

            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    
                    // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ JSON
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);
                    
                    if (jsonData.length === 0) {
                        showMessage(messageDiv, '–§–∞–π–ª Excel –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã—Ö', 'error');
                        return;
                    }
                    
                    const jsonString = JSON.stringify(jsonData, null, 2);
                    
                    // –°–æ–∑–¥–∞–µ–º –∏ —Å–∫–∞—á–∏–≤–∞–µ–º JSON —Ñ–∞–π–ª
                    const blob = new Blob([jsonString], { type: 'application/json;charset=utf-8;' });
                    const link = document.createElement('a');
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', 'converted_data.json');
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);

                    showMessage(messageDiv, `–£—Å–ø–µ—à–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${jsonData.length} –∑–∞–ø–∏—Å–µ–π –≤ JSON!`, 'success');
                    
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:', error);
                    showMessage(messageDiv, '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏: ' + error.message, 'error');
                }
            };
            
            reader.onerror = function() {
                showMessage(messageDiv, '–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞', 'error');
            };
            
            reader.readAsArrayBuffer(currentExcelData);
        }

        function showMessage(messageDiv, text, type) {
            messageDiv.innerHTML = text;
            messageDiv.className = `message ${type}`;
            messageDiv.style.display = 'block';
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }

        function clearJsonInput() {
            document.getElementById('jsonInput').value = '';
            document.getElementById('jsonInput').classList.remove('valid', 'invalid');
            document.getElementById('jsonUrl').value = '';
            document.getElementById('jsonUrl').classList.remove('valid', 'invalid');
            document.getElementById('jsonMessage').style.display = 'none';
        }

        function clearExcelInput() {
            document.getElementById('excelFile').value = '';
            document.getElementById('convertExcelBtn').disabled = true;
            document.getElementById('excelMessage').style.display = 'none';
            currentExcelData = null;
        }

        // –í–∞–ª–∏–¥–∞—Ü–∏—è JSON –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        document.getElementById('jsonInput').addEventListener('input', function() {
            const jsonText = this.value.trim();
            if (jsonText) {
                const validation = validateJson(jsonText);
                if (validation.valid) {
                    this.classList.remove('invalid');
                    this.classList.add('valid');
                } else {
                    this.classList.remove('valid');
                    this.classList.add('invalid');
                }
            } else {
                this.classList.remove('valid', 'invalid');
            }
        });

        // –í–∞–ª–∏–¥–∞—Ü–∏—è URL –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
        document.getElementById('jsonUrl').addEventListener('input', function() {
            const url = this.value.trim();
            if (url) {
                if (validateUrl(url)) {
                    this.classList.remove('invalid');
                    this.classList.add('valid');
                } else {
                    this.classList.remove('valid');
                    this.classList.add('invalid');
                }
            } else {
                this.classList.remove('valid', 'invalid');
            }
        });

        // Google Analytics (–∑–∞–º–µ–Ω–∏—Ç–µ GA_MEASUREMENT_ID –Ω–∞ –≤–∞—à ID)
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID');
    </script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    
    <!-- Yandex.Metrika (–∑–∞–º–µ–Ω–∏—Ç–µ XXXXXX –Ω–∞ –≤–∞—à ID) -->
    <script type="text/javascript" >
       (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
       m[i].l=1*new Date();
       for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
       k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
       (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
       ym(XXXXXX, "init", {
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true
       });
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/XXXXXX" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
</body>
</html>
