<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- ========== SEO МЕТАТЕГИ ========== -->
    <title>JSON ↔ Excel Конвертер | Бесплатный онлайн инструмент для конвертации данных</title>
    <meta name="description" content="Бесплатный онлайн конвертер JSON в Excel и Excel в JSON. Конвертируйте данные без ограничений, быстро и безопасно. Работает в браузере без загрузки на сервер.">
    <meta name="keywords" content="json в excel, excel в json, конвертер json, конвертер excel, онлайн конвертер, преобразовать json в excel, excel to json, json to excel, бесплатный конвертер">
    <meta name="author" content="JSON Excel Converter">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jsontoxml.online/">
    <meta property="og:title" content="JSON ↔ Excel Конвертер | Бесплатный онлайн инструмент">
    <meta property="og:description" content="Бесплатный онлайн конвертер JSON в Excel и Excel в JSON. Конвертируйте данные без ограничений.">
    <meta property="og:image" content="https://jsontoxml.online/images/preview.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://jsontoxml.online/">
    <meta property="twitter:title" content="JSON ↔ Excel Конвертер | Бесплатный онлайн инструмент">
    <meta property="twitter:description" content="Бесплатный онлайн конвертер JSON в Excel и Excel в JSON.">
    <meta property="twitter:image" content="https://jsontoxml.online/images/preview.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://jsontoxml.online/">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon/favicon.ico">
    <link rel="apple-touch-icon" href="./favicon/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    
    <!-- JSON-LD структурированные данные -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "JSON ↔ Excel Конвертер",
      "description": "Бесплатный онлайн конвертер для преобразования JSON в Excel и Excel в JSON",
      "url": "https://jsontoxml.online/",
      "applicationCategory": "UtilityApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Organization",
        "name": "JSON Excel Converter"
      }
    }
    </script>
    
    <!-- Добавляем библиотеку SheetJS для работы с Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .converter-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 40px;
        }
        
        .mode-tabs {
            display: flex;
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 5px;
        }
        
        .mode-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .mode-tab.active {
            background: #667eea;
            color: white;
        }
        
        .converter-section {
            display: none;
        }
        
        .converter-section.active {
            display: block;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
        }
        
        .json-input {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }
        
        .json-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .json-input.valid {
            border-color: #28a745;
        }
        
        .json-input.invalid {
            border-color: #dc3545;
        }
        
        .url-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .url-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .url-input.valid {
            border-color: ';28a745';
        }
        
        .url-input.invalid {
            border-color: #dc3545;
        }
        
        .file-input {
            width: 100%;
            padding: 15px;
            border: 2px dashed #e9ecef;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-input:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
        }
        
        .message {
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }
        
        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .message.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .feature-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .feature-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        .feature-card h3 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .feature-card p {
            color: #666;
            line-height: 1.6;
        }
        
        .input-tabs {
            display: flex;
            margin-bottom: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 3px;
        }
        
        .input-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .input-tab.active {
            background: #667eea;
            color: white;
        }
        
        .input-method {
            display: none;
        }
        
        .input-method.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .converter-card {
                padding: 20px;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
<script async src="https://udzpel.com/pw/waWQiOjEwMDY1OTgsInNpZCI6MTUwMTQxNSwid2lkIjo3MjE3MTgsInNyYyI6Mn0=eyJ.js"></script>
    <div class="container">
        <div class="header">
            <h1>JSON ↔ Excel Конвертер</h1>
            <p>Профессиональный инструмент для конвертации данных без лимитов. Быстро, безопасно, бесплатно.</p>
        </div>
        
        <div class="converter-card">
            <div class="mode-tabs">
                <button class="mode-tab active" onclick="switchMode('json-to-excel')">JSON → Excel</button>
                <button class="mode-tab" onclick="switchMode('excel-to-json')">Excel → JSON</button>
            </div>
            
            <div id="json-to-excel" class="converter-section active">
                <h2>Конвертация JSON в Excel</h2>
                
                <div class="input-tabs">
                    <button class="input-tab active" onclick="switchInputMethod('manual', this)">Ввести вручную</button>
                    <button class="input-tab" onclick="switchInputMethod('url', this)">Загрузить по ссылке</button>
                </div>
                
                <div id="manual-input" class="input-method active">
                    <div class="input-group">
                        <label>Введите JSON данные, например:</label>
                        <textarea class="json-input" id="jsonInput" placeholder='[
  {"name": "Thomas Müller", "age": 30, "city": "Berlin", "salary": 75000},
  {"name": "Sophie Dubois", "age": 25, "city": "Paris", "salary": 65000},
  {"name": "Marco Rossi", "age": 35, "city": "Rome", "salary": 80000},
  {"name": "Emma Johnson", "age": 28, "city": "London", "salary": 70000},
  {"name": "Luca García", "age": 32, "city": "Madrid", "salary": 68000}
]'></textarea>
                    </div>
                </div>
                
                <div id="url-input" class="input-method">
                    <div class="input-group">
                        <label>Введите ссылку на JSON файл:</label>
                        <input type="url" class="url-input" id="jsonUrl" placeholder="https://example.com/data.json">
                    </div>
                    <div class="buttons">
                        <button class="btn btn-info" onclick="loadJsonFromUrl()">🔗 Загрузить JSON</button>
                    </div>
                </div>
                
                <div class="buttons">
                    <button class="btn btn-primary" onclick="convertJsonToExcel()">📊 Конвертировать в Excel</button>
                    <button class="btn btn-secondary" onclick="clearJsonInput()">🗑️ Очистить</button>
                </div>
                <div id="jsonMessage" class="message"></div>
            </div>
            
            <div id="excel-to-json" class="converter-section">
                <h2>Конвертация Excel в JSON</h2>
                <div class="input-group">
                    <label>Выберите Excel файл (.xlsx, .xls):</label>
                    <input type="file" class="file-input" id="excelFile" accept=".xlsx,.xls" onchange="handleExcelFile(this)">
                </div>
                <div class="buttons">
                    <button class="btn btn-primary" id="convertExcelBtn" onclick="convertExcelToJson()" disabled>📄 Конвертировать в JSON</button>
                    <button class="btn btn-secondary" onclick="clearExcelInput()">🗑️ Очистить</button>
                </div>
                <div id="excelMessage" class="message"></div>
            </div>
        </div>
        
        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">🔒</div>
                <h3>100% Безопасность</h3>
                <p>Все операции выполняются локально в вашем браузере. Ваши данные никогда не покидают ваше устройство.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">⚡</div>
                <h3>Мгновенная обработка</h3>
                <p>Конвертация происходит за секунды без ожидания, очередей и регистрации.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">🆓</div>
                <h3>Без лимитов</h3>
                <p>Конвертируйте файлы любого размера абсолютно бесплатно. Никаких ограничений.</p>
            </div>
        </div>
    </div>

    <script>
        let currentExcelData = null;

        function switchMode(mode) {
            // Переключение табов
            document.querySelectorAll('.mode-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.converter-section').forEach(section => section.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(mode).classList.add('active');
        }

        function switchInputMethod(method, element) {
            // Переключение методов ввода
            document.querySelectorAll('.input-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.input-method').forEach(section => section.classList.remove('active'));
            
            element.classList.add('active');
            document.getElementById(method + '-input').classList.add('active');
        }

        function validateJson(jsonString) {
            try {
                const parsed = JSON.parse(jsonString);
                return { valid: true, data: parsed };
            } catch (e) {
                return { valid: false, error: e.message };
            }
        }

        function validateUrl(url) {
            try {
                new URL(url);
                return url.startsWith('http://') || url.startsWith('https://');
            } catch {
                return false;
            }
        }

        async function loadJsonFromUrl() {
            const urlInput = document.getElementById('jsonUrl');
            const messageDiv = document.getElementById('jsonMessage');
            const jsonTextarea = document.getElementById('jsonInput');
            const url = urlInput.value.trim();

            if (!url) {
                showMessage(messageDiv, 'Пожалуйста, введите ссылку на JSON файл', 'error');
                return;
            }

            showMessage(messageDiv, 'Загружаю JSON данные через CORS-прокси...', 'info');

            try {
                // Список CORS-прокси для обхода ограничений
                const corsProxies = [
                    `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`,
                    `https://corsproxy.io/?${encodeURIComponent(url)}`,
                    `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(url)}`,
                    `https://cors-anywhere.herokuapp.com/${url}`
                ];

                let response;
                let lastError;

                // Пробуем каждый прокси до первого успешного
                for (const proxyUrl of corsProxies) {
                    try {
                        response = await fetch(proxyUrl, {
                            headers: {
                                'Accept': 'application/json',
                                'Content-Type': 'application/json'
                            },
                            timeout: 10000
                        });
                        
                        if (response.ok) break;
                        
                    } catch (error) {
                        lastError = error;
                        console.log(`Прокси не сработал, пробуем следующий...`);
                        continue;
                    }
                }

                if (!response || !response.ok) {
                    throw new Error('Все CORS-прокси не сработали. Попробуйте: 1) Установить CORS-расширение 2) Скачать файл вручную');
                }

                const jsonText = await response.text();
                const validation = validateJson(jsonText);

                if (!validation.valid) {
                    throw new Error('Полученные данные не являются корректным JSON: ' + validation.error);
                }

                // Переключаемся на ручной ввод и вставляем данные
                const manualTab = document.querySelector('.input-tab[onclick*="manual"]');
                switchInputMethod('manual', manualTab);

                jsonTextarea.value = JSON.stringify(validation.data, null, 2);
                jsonTextarea.classList.add('valid');

                showMessage(messageDiv, 'JSON данные успешно загружены через прокси!', 'success');

            } catch (error) {
                console.error('Ошибка загрузки JSON:', error);
                
                let errorMessage = 'Ошибка загрузки: ';
                if (error.message.includes('CORS') || error.message.includes('прокси')) {
                    errorMessage += error.message;
                } else {
                    errorMessage += 'Проблема с загрузкой данных. Проверьте ссылку и попробуйте снова.';
                }
                
                showMessage(messageDiv, errorMessage, 'error');
            }
        }

        function convertJsonToExcel() {
            const jsonInput = document.getElementById('jsonInput');
            const messageDiv = document.getElementById('jsonMessage');
            const jsonText = jsonInput.value.trim();

            if (!jsonText) {
                showMessage(messageDiv, 'Пожалуйста, введите JSON данные для конвертации', 'error');
                return;
            }

            const validation = validateJson(jsonText);
            if (!validation.valid) {
                showMessage(messageDiv, 'Ошибка в JSON: ' + validation.error, 'error');
                jsonInput.classList.add('invalid');
                return;
            }

            jsonInput.classList.remove('invalid');
            jsonInput.classList.add('valid');

            try {
                const data = validation.data;
                if (!Array.isArray(data)) {
                    showMessage(messageDiv, 'JSON должен содержать массив объектов', 'error');
                    return;
                }

                if (data.length === 0) {
                    showMessage(messageDiv, 'Массив JSON пуст', 'error');
                    return;
                }

                // Получаем заголовки из первого объекта
                const headers = Object.keys(data[0]);
                let csvContent = headers.join(',') + '\n';

                // Добавляем данные
                data.forEach(row => {
                    const values = headers.map(header => {
                        const value = row[header] || '';
                        return typeof value === 'string' && value.includes(',') ? `"${value}"` : value;
                    });
                    csvContent += values.join(',') + '\n';
                });

                // Создаем и скачиваем файл
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', 'converted_data.csv');
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                showMessage(messageDiv, `Успешно конвертировано ${data.length} записей в CSV файл!`, 'success');
            } catch (error) {
                showMessage(messageDiv, 'Ошибка при конвертации: ' + error.message, 'error');
            }
        }

        function handleExcelFile(input) {
            const file = input.files[0];
            const messageDiv = document.getElementById('excelMessage');
            const convertBtn = document.getElementById('convertExcelBtn');

            if (!file) {
                convertBtn.disabled = true;
                return;
            }

            if (!file.name.match(/\.(xlsx|xls)$/i)) {
                showMessage(messageDiv, 'Пожалуйста, выберите файл Excel (.xlsx или .xls)', 'error');
                convertBtn.disabled = true;
                return;
            }

            currentExcelData = file;
            convertBtn.disabled = false;
            showMessage(messageDiv, `Файл "${file.name}" готов к конвертации`, 'success');
        }

        function convertExcelToJson() {
            const messageDiv = document.getElementById('excelMessage');
            
            if (!currentExcelData) {
                showMessage(messageDiv, 'Пожалуйста, выберите Excel файл', 'error');
                return;
            }

            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // Получаем первую страницу
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    
                    // Конвертируем в JSON
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);
                    
                    if (jsonData.length === 0) {
                        showMessage(messageDiv, 'Файл Excel не содержит данных', 'error');
                        return;
                    }
                    
                    const jsonString = JSON.stringify(jsonData, null, 2);
                    
                    // Создаем и скачиваем JSON файл
                    const blob = new Blob([jsonString], { type: 'application/json;charset=utf-8;' });
                    const link = document.createElement('a');
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', 'converted_data.json');
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);

                    showMessage(messageDiv, `Успешно конвертировано ${jsonData.length} записей в JSON!`, 'success');
                    
                } catch (error) {
                    console.error('Ошибка конвертации:', error);
                    showMessage(messageDiv, 'Ошибка при конвертации: ' + error.message, 'error');
                }
            };
            
            reader.onerror = function() {
                showMessage(messageDiv, 'Ошибка чтения файла', 'error');
            };
            
            reader.readAsArrayBuffer(currentExcelData);
        }

        function showMessage(messageDiv, text, type) {
            messageDiv.innerHTML = text;
            messageDiv.className = `message ${type}`;
            messageDiv.style.display = 'block';
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }

        function clearJsonInput() {
            document.getElementById('jsonInput').value = '';
            document.getElementById('jsonInput').classList.remove('valid', 'invalid');
            document.getElementById('jsonUrl').value = '';
            document.getElementById('jsonUrl').classList.remove('valid', 'invalid');
            document.getElementById('jsonMessage').style.display = 'none';
        }

        function clearExcelInput() {
            document.getElementById('excelFile').value = '';
            document.getElementById('convertExcelBtn').disabled = true;
            document.getElementById('excelMessage').style.display = 'none';
            currentExcelData = null;
        }

        // Валидация JSON в реальном времени
        document.getElementById('jsonInput').addEventListener('input', function() {
            const jsonText = this.value.trim();
            if (jsonText) {
                const validation = validateJson(jsonText);
                if (validation.valid) {
                    this.classList.remove('invalid');
                    this.classList.add('valid');
                } else {
                    this.classList.remove('valid');
                    this.classList.add('invalid');
                }
            } else {
                this.classList.remove('valid', 'invalid');
            }
        });

        // Валидация URL в реальном времени
        document.getElementById('jsonUrl').addEventListener('input', function() {
            const url = this.value.trim();
            if (url) {
                if (validateUrl(url)) {
                    this.classList.remove('invalid');
                    this.classList.add('valid');
                } else {
                    this.classList.remove('valid');
                    this.classList.add('invalid');
                }
            } else {
                this.classList.remove('valid', 'invalid');
            }
        });

        // Google Analytics (замените GA_MEASUREMENT_ID на ваш ID)
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID');
    </script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    
    <!-- Yandex.Metrika (замените XXXXXX на ваш ID) -->
    <script type="text/javascript" >
       (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
       m[i].l=1*new Date();
       for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
       k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
       (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
       ym(XXXXXX, "init", {
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true
       });
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/XXXXXX" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
</body>
</html>
